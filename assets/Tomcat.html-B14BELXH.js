import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,c as d,b as s,d as t,w as e,a as h,e as a,o as p}from"./app--VhlLr_b.js";const o={},c={class:"table-of-contents"};function g(u,i){const l=n("router-link"),r=n("RouteLink");return p(),d("div",null,[i[15]||(i[15]=s("h1",{id:"tomcat",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#tomcat"},[s("span",null,"Tomcat")])],-1)),s("nav",c,[s("ul",null,[s("li",null,[t(l,{to:"#flag"},{default:e(()=>i[0]||(i[0]=[a("Flag")])),_:1})]),s("li",null,[t(l,{to:"#其他应用服务器"},{default:e(()=>i[1]||(i[1]=[a("其他应用服务器")])),_:1})]),s("li",null,[t(l,{to:"#执行器-线程池"},{default:e(()=>i[2]||(i[2]=[a("执行器（线程池）")])),_:1})]),s("li",null,[t(l,{to:"#连接器优化"},{default:e(()=>i[3]||(i[3]=[a("连接器优化")])),_:1})]),s("li",null,[t(l,{to:"#禁用ajp连接器"},{default:e(()=>i[4]||(i[4]=[a("禁用AJP连接器")])),_:1})]),s("li",null,[t(l,{to:"#http头的验证"},{default:e(()=>i[5]||(i[5]=[a("http头的验证")])),_:1})]),s("li",null,[t(l,{to:"#tomcat热部署"},{default:e(()=>i[6]||(i[6]=[a("Tomcat热部署")])),_:1})]),s("li",null,[t(l,{to:"#问题及解决方案"},{default:e(()=>i[7]||(i[7]=[a("问题及解决方案")])),_:1}),s("ul",null,[s("li",null,[t(l,{to:"#_403accessdenied"},{default:e(()=>i[8]||(i[8]=[a("403AccessDenied")])),_:1})]),s("li",null,[t(l,{to:"#启动时一直卡100"},{default:e(()=>i[9]||(i[9]=[a("启动时一直卡100%")])),_:1})]),s("li",null,[t(l,{to:"#请考虑增加缓存的最大空间"},{default:e(()=>i[10]||(i[10]=[a("请考虑增加缓存的最大空间")])),_:1})])])]),s("li",null,[t(l,{to:"#centos安装tomcat"},{default:e(()=>i[11]||(i[11]=[a("CentOS安装Tomcat")])),_:1})]),s("li",null,[t(l,{to:"#window运行"},{default:e(()=>i[12]||(i[12]=[a("window运行")])),_:1})])])]),i[16]||(i[16]=h(`<h2 id="flag" tabindex="-1"><a class="header-anchor" href="#flag"><span>Flag</span></a></h2><ul><li><a href="https://github.com/topics/tomcat" target="_blank" rel="noopener noreferrer">https://github.com/topics/tomcat</a></li><li><a href="https://github.com/apache/tomcat" target="_blank" rel="noopener noreferrer">https://github.com/apache/tomcat</a><ul><li><a href="https://tomcat.apache.org" target="_blank" rel="noopener noreferrer">https://tomcat.apache.org</a></li></ul></li></ul><ul><li>Tomcat集群Redis会话管理器 <a href="https://github.com/ran-jit/tomcat-cluster-redis-session-manager" target="_blank" rel="noopener noreferrer">https://github.com/ran-jit/tomcat-cluster-redis-session-manager</a></li><li><a href="https://github.com/magro/memcached-session-manager" target="_blank" rel="noopener noreferrer">https://github.com/magro/memcached-session-manager</a></li><li>Tomcat监控 <a href="https://github.com/psi-probe" target="_blank" rel="noopener noreferrer">https://github.com/psi-probe</a></li></ul><ul><li><a href="http://gv7.me/archives" target="_blank" rel="noopener noreferrer">归档 | 回忆飘如雪</a></li><li><a href="https://blog.csdn.net/localhost01/article/details/107340698" target="_blank" rel="noopener noreferrer">Shiro的反序列化漏洞，以及内存马技术</a></li><li><a href="https://xz.aliyun.com/t/9450" target="_blank" rel="noopener noreferrer">Java Agent 从入门到内存马</a></li><li><a href="https://blog.51cto.com/zero01/2145077" target="_blank" rel="noopener noreferrer">Tomcat性能监控与调优</a></li><li><a href="https://zhuanlan.zhihu.com/p/150135605" target="_blank" rel="noopener noreferrer">超详细的Tomcat性能监控及调优教程</a></li><li><a href="https://blog.csdn.net/qq_29534483/article/details/80744027" target="_blank" rel="noopener noreferrer">Gzip无法压缩48k以上的资源？</a></li></ul><blockquote><p>因为Tomcat运行在JAVA虚拟机之上,适当调整运行JVM参数可以提升整体性能。</p></blockquote><ul><li>Windows：修改<code>bin/catalina.bat</code>文件，文件中有注释说明，配置JVM参数：<code>set &quot;JAVA_OPTS=%JAVA_OPTS% -Dfile.encoding=UTF-8&quot;</code></li><li>Linux：修改<code>bin/catalina.sh</code>文件，文件中有注释说明，配置JVM参数：<code>JAVA_OPTS=&quot;$JAVA_OPTS -Dfile.encoding=UTF-8&quot;</code></li></ul><h2 id="其他应用服务器" tabindex="-1"><a class="header-anchor" href="#其他应用服务器"><span>其他应用服务器</span></a></h2><ul><li><a href="https://github.com/Aresyi/HowTomcatWorks" target="_blank" rel="noopener noreferrer">https://github.com/Aresyi/HowTomcatWorks</a></li><li><a href="https://github.com/wildfly/wildfly" target="_blank" rel="noopener noreferrer">https://github.com/wildfly/wildfly</a><ul><li><a href="https://github.com/thorntail/thorntail" target="_blank" rel="noopener noreferrer">https://github.com/thorntail/thorntail</a></li></ul></li><li><a href="https://github.com/undertow-io/undertow" target="_blank" rel="noopener noreferrer">https://github.com/undertow-io/undertow</a></li><li><a href="https://github.com/eclipse/jetty.project" target="_blank" rel="noopener noreferrer">https://github.com/eclipse/jetty.project</a></li><li><a href="https://github.com/eclipse-ee4j/grizzly" target="_blank" rel="noopener noreferrer">https://github.com/eclipse-ee4j/grizzly</a></li><li><a href="https://github.com/eclipse-ee4j/glassfish" target="_blank" rel="noopener noreferrer">https://github.com/eclipse-ee4j/glassfish</a><ul><li><a href="https://github.com/payara/Payara" target="_blank" rel="noopener noreferrer">https://github.com/payara/Payara</a></li></ul></li></ul><h2 id="执行器-线程池" tabindex="-1"><a class="header-anchor" href="#执行器-线程池"><span>执行器（线程池）</span></a></h2><blockquote><p><code>Executor</code> Tomcat默认没有启用线程池，在tomcat中每一个用户请求都是一个线程，所以可以使用线程池提高性能。 这里前台其实有一个调度线程，然后调度线程会放入线程池内，然后到到一定的时候线程池的任务变成工作线程。</p></blockquote><ul><li>在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Executor</code>标签取消注释</li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Executor</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tomcatThreadPool&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> namePrefix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;catalina-exec-&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        maxThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;800&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> minSpareThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;100&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  maxQueueSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;100&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> prestartminSpareThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>命名线程池</td></tr><tr><td>threadPriority</td><td>优先级</td></tr><tr><td>daemon</td><td>守护进程</td></tr><tr><td>namePrefix</td><td>名称前缀</td></tr><tr><td>maxThreads</td><td>最大线程数</td></tr><tr><td>minSpareThreads</td><td>最小活跃线程数</td></tr><tr><td>maxIdleTime</td><td>空闲线程等待时间</td></tr><tr><td>maxQueueSize</td><td>最大的等待队里数，超过则请求拒绝</td></tr><tr><td>prestartminSpareThreads</td><td>是否在启动时就生成minSpareThreads个线程</td></tr><tr><td>threadRenewalDelay</td><td>重建线程的时间间隔</td></tr></tbody></table><ul><li>连接器指定线程池：在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Connector</code>，使用<code>executor=&quot;线程池名称&quot;</code></li></ul><h2 id="连接器优化" tabindex="-1"><a class="header-anchor" href="#连接器优化"><span>连接器优化</span></a></h2><blockquote><p>Connector是连接器，负责接收客户的请求，以及向客户端回送响应的消息。所以 Connector的优化是重要部分。 默认情况下 Tomcat只支持200线程访问，超过这个数量的连接将被等待甚至超时放弃，所以我们需要提高这方面的处理能力。</p></blockquote><ul><li><a href="https://blog.csdn.net/qq_34556414/article/details/109176069" target="_blank" rel="noopener noreferrer">Tomcat 连接器Connector 的三种运行模式 Bio、Nio、Apr</a></li></ul><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>maxPostSize</td><td>参数形式处理的最大长度，默认值为2097152（2兆字节）。上传提交的时候可以用的</td></tr><tr><td>acceptCount</td><td>请求的最大队列长度，当队列满时收到的任何请求将被拒绝</td></tr><tr><td>acceptorThreadCount</td><td>用于接受连接的线程的数量</td></tr><tr><td>disableUploadTimeout</td><td>此标志允许servlet容器在数据上传时使用不同的连接超时，通常较长。如果没有指定，该属性被设置为true，禁用上传超时。</td></tr><tr><td>connectionUploadTimeout</td><td>上传数据过程中，指定的以毫秒为单位超时时间。只有在设置disableUploadTimeout为false有效。</td></tr><tr><td>connectionTimeout</td><td>在将提交的请求URI行呈现之后，连接器将等待接受连接的毫秒数。使用值-1表示没有超时（即无限）。默认值是60000（60秒），但请注意，Tomcat的标准server.xml中，设置为20000（即20秒）。</td></tr><tr><td>maxConnections</td><td>服务器接受并处理的最大连接数</td></tr><tr><td>SSLEnabled</td><td>在连接器上使用此属性来启用SSL加密传输</td></tr><tr><td>port</td><td>TCP端口号，连接器利用该端口号将创建一个服务器套接字，并等待传入的连接。</td></tr><tr><td>protocol</td><td>设置协议来处理传入流量。默认值是 HTTP/1.1，将使用自动切换机制来选择阻塞的基于Java的连接器或APR /native 为基础的连接器。可用以下值：org.apache.coyote.http11.Http11Protocol -阻塞式的Java连接器;org.apache.coyote.http11.Http11NioProtocol -不阻塞Java连接器;org.apache.coyote.http11.Http11AprProtocol的 -的APR / native 连接器</td></tr><tr><td>maxThreads</td><td>最多同时处理的连接数，Tomcat使用线程来处理接收的每个请求。这个值表示Tomcat可创建的最大的线程数。如果没有指定，该属性被设置为200。如果使用了execute将忽略此连接器的该属性，连接器将使用execute，而不是一个内部线程池来处理请求。</td></tr><tr><td>minSpareThreads</td><td>始终保持运行最小线程数。如果没有指定，则默认为10。</td></tr><tr><td>maxHttpHeaderSize</td><td>请求和响应的HTTP头的（以字节为单位的）最大尺寸。如果没有指定，该属性被设置为8192（8 KB）。</td></tr><tr><td>tcpNoDelay</td><td>如果设置为true，TCP_NO_DELAY选项将被设置在服务器上的套接字上，在大多数情况下，这样可以提高性能。默认设置为true。</td></tr><tr><td>compression</td><td>通常会在ngnix里面配置压缩开启压缩GZIP，当值是“off ”（禁用压缩），“on ”（允许压缩，这会导致文本数据被压缩），“force ”（强制在所有的情况下压缩），或者一个整数值（这是相当于为“on”，但指定了输出之前被压缩的数据最小量）。如果不知道内容长度但被设置为“on”或更积极的压缩，输出的数据也将被压缩。如果没有指定，该属性被设置为“off”。</td></tr><tr><td>compressionMinSize</td><td>如果压缩被设置为“on”，那么该属性可以用于指定在输出之前被压缩的数据的最小量。如果未指定，此属性默认为“2048”。</td></tr><tr><td>redirectPort</td><td>如果该连接器支持非SSL请求，并且接收到的请求为满足安全约束需要SSL传输， Catalina 将自动将请求重定向到指定的端口号。</td></tr><tr><td>enableLookups</td><td>设置为false时跳过DNS查找，并返回字符串情势的IP地址（从而提高性能）。默认景象下，禁用DNS查找。</td></tr><tr><td>URIEncoding</td><td>指定使用的字符编码，来解码URI字符。如果没有指定，ISO-8859-1将被使用。</td></tr><tr><td>executor</td><td>指向Executor元素的引用。</td></tr><tr><td>compressableMimeType</td><td>可以在<code>conf/web.xml</code>中的<code>Default MIME Type Mappings</code>部分找到</td></tr></tbody></table><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Connector</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> executor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tomcatThreadPool&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        connectionTimeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;20000&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8080&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;org.apache.coyote.http11.Http11Nio2Protocol&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        redirectPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8443&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        maxHttpHeaderSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8192&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        enableLookups</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;false&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        maxPostSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1048576000&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        URIEncoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        acceptCount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1000&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        acceptorTreadCount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;100&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        disableUploadTimeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        maxConnections</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;10000&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        SSLEnabled</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;false&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        compression</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;on&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        compressionMinSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2048&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        noCompressionUserAgents</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;gozilla,traviata&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        compressableMimeType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text/html,text/xml,application/javascript,text/javascript,text/css,text/plain,text/json&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="禁用ajp连接器" tabindex="-1"><a class="header-anchor" href="#禁用ajp连接器"><span>禁用AJP连接器</span></a></h2><ul><li>如果是使用<code>Nginx</code>+<code>tomcat</code>的架构，所以用不着<code>AJP</code>协议，所以把<code>AJP</code>连接器禁用。</li></ul><blockquote><p>AJPv13协议是面向包的。WEB服务器和Servlet容器通过TCP连接来交互；为了节省SOCKET创建的昂贵代价， WEB服务器会尝试维护一个永久TCP连接到servlet容器，并且在多个请求和响应周期过程会重用连接。</p></blockquote><ul><li>在<code>server.xml</code>中找到<code>&lt;Service name=&quot;Catalina&quot;&gt;</code>节点下的<code>Connector</code>标签带有<code>protocol=&quot;AJP/1.3&quot;</code>属性的注释掉</li></ul><h2 id="http头的验证" tabindex="-1"><a class="header-anchor" href="#http头的验证"><span>http头的验证</span></a></h2><blockquote><p>Tomcat在 <code>7.0.73</code>、<code>8.0.39</code>、以及<code>8.5.7</code>版本后，添加了对于<code>http</code>头的验证。</p></blockquote><ul><li>在<code>conf/catalina.properties</code>文件的末尾添加或者修改最后一行</li></ul><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">tomcat.util.http.parser.HttpParser.requestTargetAllow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">|{}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="tomcat热部署" tabindex="-1"><a class="header-anchor" href="#tomcat热部署"><span>Tomcat热部署</span></a></h2><ul><li>在<code>/conf/context.xml</code>的<code>Context</code>标签中配置会使全局生效</li></ul><ul><li><a href="https://tomcat.apache.org/tomcat-9.0-doc/config/context.html#Attributes" target="_blank" rel="noopener noreferrer">https://tomcat.apache.org/tomcat-9.0-doc/config/context.html#Attributes</a></li></ul><ul><li>在<code>/conf/server.xml</code>的<code>Host</code>标签中配置</li></ul><blockquote><p>替换<code>WEB-INF/lib</code>目录中的<code>jar</code>文件或<code>WEB-INF/classes</code>目录中的<code>class</code>文件时， <code>reloadable=&quot;true&quot;</code>会让修改生效（但代价不小），该选项适合调试。</p></blockquote><blockquote><p>在<code>webapps</code>目录中增加新的目录、<code>war</code>文件、修改<code>WEB-INF/web.xml</code>，<code>autoDeploy=&quot;true&quot;</code>会新建或重新部署应用，该选项方便部署。</p></blockquote><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Context</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> docBase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/xxx&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> reloadable</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> autoDeploy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="问题及解决方案" tabindex="-1"><a class="header-anchor" href="#问题及解决方案"><span>问题及解决方案</span></a></h2><ul><li><a href="https://www.cnblogs.com/zhaler/p/16232850.html" target="_blank" rel="noopener noreferrer">eclipse启动tomcat提示端口被占用 实际端口并没有被占用 重启也没用</a></li></ul><h3 id="_403accessdenied" tabindex="-1"><a class="header-anchor" href="#_403accessdenied"><span>403AccessDenied</span></a></h3><blockquote><p><code>tomcat8</code>以上管理页面提示<code>403 Access Denied</code>问题</p></blockquote><ul><li>修改<code>conf/tomcat-users.xml</code></li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> conf/tomcat-users.xml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>按<code>shift+g</code>跳到末尾,在<code>&lt;/tomcat-users&gt;</code>前添加</li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">role</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> rolename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;manager-gui&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">role</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> rolename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;manager-script&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">role</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> rolename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;admin-gui&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">role</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> rolename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;admin-script&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">user</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> username</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tomcat&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> password</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;密码&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> roles</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;manager-gui,manager-script,admin-gui,admin-script&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>修改<code>context.xml</code></li></ul><blockquote><p>打开<code>webapps</code>下的<code>host-manager</code>和<code>manager</code>，在<code>META-INF</code>里面都有<code>context.xml</code></p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> webapps/manager/META-INF/context.xml</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> webapps/host-manager/META-INF/context.xml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>修改<code>&lt;Context antiResourceLocking=&quot;false&quot; privileged=&quot;true&quot; &gt;</code>节点</p></blockquote><blockquote><p>这段代码的作用是限制来访IP的，<code>127.d+.d+.d+|::1|0:0:0:0:0:0:0:1</code>是正则表达式，表示<code>IPv4</code>和<code>IPv6</code>的本机环回地址</p></blockquote><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Valve</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> className</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;org.apache.catalina.valves.RemoteAddrValve&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     allow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1|\\d+\\.\\d+\\.\\d+\\.\\d+&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启动时一直卡100" tabindex="-1"><a class="header-anchor" href="#启动时一直卡100"><span>启动时一直卡100%</span></a></h3><ol><li>有可能是mybatis的mapper XML多了（比如删除了dao，而没有删除xml）</li><li>还有可能是xml内的语法或元素错误（比如两个标签的id重复）</li><li>或者没有对用到的实体类进行扫描</li><li>检查xml中映射的实体类全限定路径（改了包名）</li></ol><ul><li><a href="https://www.dandelioncloud.cn/article/details/1510442490028216321" target="_blank" rel="noopener noreferrer">eclipse+tomcat 启动已有工程时卡在starting100%状态的解决办法</a></li><li><a href="https://bbs.csdn.net/topics/392322747" target="_blank" rel="noopener noreferrer">tomcat启动时卡在100%（preparing launch delegate...）</a></li></ul><h3 id="请考虑增加缓存的最大空间" tabindex="-1"><a class="header-anchor" href="#请考虑增加缓存的最大空间"><span>请考虑增加缓存的最大空间</span></a></h3><ul><li><a href="https://tomcat.apache.org/tomcat-9.0-doc/config/resources.html#Attributes" target="_blank" rel="noopener noreferrer">https://tomcat.apache.org/tomcat-9.0-doc/config/resources.html#Attributes</a></li></ul><ul><li>编辑<code>tomcat\\conf\\context.xml</code>或<code>webapp\\META-INF\\context.xml</code>文件</li></ul><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- cachingAllowed是否缓存静态资源 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Resources</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> cachingAllowed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> cacheMaxSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;102400&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> cacheObjectMaxSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1024&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="centos安装tomcat" tabindex="-1"><a class="header-anchor" href="#centos安装tomcat"><span>CentOS安装Tomcat</span></a></h2><ul><li><a href="https://tomcat.apache.org" target="_blank" rel="noopener noreferrer">https://tomcat.apache.org</a></li></ul><p><strong>解压</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.31.tar.gz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>重命名目录</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.31</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat-8080</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>复制目录</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat-8080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat-8082</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>修改第二个Tomcat配置</strong></p><blockquote><p>进入tomcat-8082的<code>bin</code>目录，修改<code>startup.sh</code>和<code>shutdown.sh</code>两个文件，都添加如下内容</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">######### tomcat 2 ##########</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">JDK安装目录</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bin</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CLASSPATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CATALINA_2_HOME</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_BASE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$CATALINA_2_BASE</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">######### tomcat 2 ##########</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>修改第二个tomcat端口,第一个不变</li></ul><blockquote><p>进入<code>/tomcat-8082/conf</code>中修改<code>server.xml</code>修改后示例如下</p></blockquote><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- 关闭端口：8005-&gt;9005 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Server</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;9005&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> shutdown</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;SHUTDOWN&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- Web端口：8080-&gt;8181 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Connector</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8181&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> maxHttpHeaderSize</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8192&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">maxThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;150&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> minSpareThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;25&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> maxSpareThreads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;75&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">enableLookups</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;false&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> redirectPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8443&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> acceptCount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;100&quot;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">connectionTimeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;20000&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> disableUploadTimeout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- 监听端口：8009-&gt;9009 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Connector</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;9009&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> enableLookups</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;false&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> redirectPort</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;8443&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> protocol</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;AJP/1.3&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>添加环境变量</strong></p><blockquote><p>在<code>/etc/profile</code>文件中加入下面内容配置环境变量</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">########## tomcat 1 ###########</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CATALINA_BASE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8080</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CATALINA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8080</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TOMCAT_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8080</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_BASE</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> TOMCAT_HOME</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">########## tomcat 1############</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">######### tomcat 2 ##########</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CATALINA_2_BASE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8082</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CATALINA_2_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8082</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TOMCAT_2_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/tomcat-8082</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_2_BASE</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CATALINA_2_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> TOMCAT_2_HOME</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">########## tomcat 2##########</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>刷新环境变量</li></ul><blockquote><p><code>source</code>命令也称为“点命令”，也就是一个点符号<code>.</code>。<code>source</code>命令通常用于重新执行刚修改的初始化文件，使之立即生效</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 或者</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="window运行" tabindex="-1"><a class="header-anchor" href="#window运行"><span>window运行</span></a></h2>`,76)),s("ul",null,[s("li",null,[t(r,{to:"/Shell/WindowsBatch.html#%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3%E8%BF%90%E8%A1%8C"},{default:e(()=>i[13]||(i[13]=[a("在文件头部添加隐藏窗口运行")])),_:1}),i[14]||(i[14]=a("并修改以下文件，执行不显示dos窗口"))])]),i[17]||(i[17]=h(`<div class="language-batch line-numbers-mode" data-highlighter="shiki" data-ext="batch" data-title="batch" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">:: window下tomcat在当前窗口启动，不在一个新的窗口启动：把start改为run</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">call</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">EXECUTABLE</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> start</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> %CMD_LINE_ARGS%</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">call</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">EXECUTABLE</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> run </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%CMD_LINE_ARGS%</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))])}const y=k(o,[["render",g],["__file","Tomcat.html.vue"]]),b=JSON.parse('{"path":"/Java/Tomcat.html","title":"Tomcat","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"Flag","slug":"flag","link":"#flag","children":[]},{"level":2,"title":"其他应用服务器","slug":"其他应用服务器","link":"#其他应用服务器","children":[]},{"level":2,"title":"执行器（线程池）","slug":"执行器-线程池","link":"#执行器-线程池","children":[]},{"level":2,"title":"连接器优化","slug":"连接器优化","link":"#连接器优化","children":[]},{"level":2,"title":"禁用AJP连接器","slug":"禁用ajp连接器","link":"#禁用ajp连接器","children":[]},{"level":2,"title":"http头的验证","slug":"http头的验证","link":"#http头的验证","children":[]},{"level":2,"title":"Tomcat热部署","slug":"tomcat热部署","link":"#tomcat热部署","children":[]},{"level":2,"title":"问题及解决方案","slug":"问题及解决方案","link":"#问题及解决方案","children":[{"level":3,"title":"403AccessDenied","slug":"_403accessdenied","link":"#_403accessdenied","children":[]},{"level":3,"title":"启动时一直卡100%","slug":"启动时一直卡100","link":"#启动时一直卡100","children":[]},{"level":3,"title":"请考虑增加缓存的最大空间","slug":"请考虑增加缓存的最大空间","link":"#请考虑增加缓存的最大空间","children":[]}]},{"level":2,"title":"CentOS安装Tomcat","slug":"centos安装tomcat","link":"#centos安装tomcat","children":[]},{"level":2,"title":"window运行","slug":"window运行","link":"#window运行","children":[]}],"git":{"createdTime":1726030162000,"updatedTime":1726030162000,"contributors":[{"name":"onni-top","email":"admin@onni.top","commits":1}]},"readingTime":{"minutes":8.69,"words":2606},"filePathRelative":"Java/Tomcat.md","localizedDate":"2024年9月11日","excerpt":"\\n\\n<h2>Flag</h2>\\n<ul>\\n<li><a href=\\"https://github.com/topics/tomcat\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://github.com/topics/tomcat</a></li>\\n<li><a href=\\"https://github.com/apache/tomcat\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://github.com/apache/tomcat</a>\\n<ul>\\n<li><a href=\\"https://tomcat.apache.org\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://tomcat.apache.org</a></li>\\n</ul>\\n</li>\\n</ul>"}');export{y as comp,b as data};
